```bash
#合并测序下机数据

#NanoFilt质控

#质控fastq转换成fasta
seqkit fq2fa CPB1660_combined_nanofilt.fq > CPB1660_combined_nanofilt.fa
#选择起始fasta
seqkit seq -m 15000 CPB1660_combined_nanofilt.fq > CPB1660_combined_nanofilt_gt15k.fq
checkv end_to_end CPB1660_combined_nanofilt_gt15k.fq ./checkv_gt15k -t 8
#查看checkv_gt15k/quality_summary.tsv文件
#如果

minimap2 -ax map-ont -Y CPB1657_cyclone_skeleton.fa CPB1657_combined_nanofilt.fq > mapping.sam
samtools sort -@ 8 mapping.sam -o mapping.sorted.bam
samtools index mapping.sorted.bam


```

三代测序数据组装。由于flye等软件均无法组装出完整的噬菌体序列。因此设计了以下路线进行组装。

1. 合并下机数据，通常cyclone下机数据为分为几个barcode的数据，首先将其合并

   ```bash
   cat barcode1.fq.gz barcode2.fq.gz > CPB1660_combined.fq.gz
   ```

2. 质控

   ```bash
   NanoFilt CPB1660_combined.fq.gz -q 10 -l 1000 > CPB1660_combined_qc.fq
   ```

3. 序列转换，checkv评估长序列的完整度以及相应数据。

   ```bash
   seqkit fq2fa CPB1660_combined_qc.fq > CPB1660_combined_qc.fa
   seqkit seq -m 15000 CPB1660_combined_qc.fa > CPB1660_combined_qc_gt15k.fa
   seqkit sort -lr CPB1660_combined_qc_gt15k.fa > CPB1660_combined_qc_gt16k_sort.fa
   checkv end_to_end CPB1660_combined_qc_gt15k_sort.fa ./checkv_gt15k -t 8
   ```

4. 查阅checkv_gt15k/quality_summary.tsv

   这里需要分请况讨论，如果最长的序列在checkv评估里显示high-quality，完整度100